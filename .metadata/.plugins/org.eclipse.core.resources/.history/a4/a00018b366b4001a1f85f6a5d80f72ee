package week2.day2.apitudehotelbeds;

import java.util.Date;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;
import javax.net.ssl.HttpsURLConnection;

import org.testng.annotations.BeforeSuite;

import io.restassured.http.Headers;
				
public class ApiTuteHotelBedsBasics {
	String apiKey = "kcc383kuzqsbhrvmwn8qumyv";
	String Secret = "85M7mGTcKM";
	String signature ;
	Headers hMap;
	String endpoint = "https://api.test.hotelbeds.com";
	String secure_endpoint = "https://api-secure.test.hotelbeds.com";
	
@BeforeSuite
	public void xSignature() {

		try {
			// Your API Key and secret
			
			// Signature is generated by SHA256 (Api-Key + Secret +
			// Timestamp (in seconds))
			 signature = org.apache.commons.codec.digest.DigestUtils
									 .sha256Hex(apiKey + Secret + System.currentTimeMillis() / 1000);
			
			// Example of call to the API
			String endpoint = "https://api.test.hotelbeds.com/hotel-api/1.0/status";
			URL url = new URL(endpoint);

			HttpsURLConnection connection = (HttpsURLConnection) url.openConnection();
			connection.setRequestProperty("X-Signature", signature);
			connection.setRequestProperty("Api-Key", apiKey);
			connection.setRequestProperty("Accept", "application/json");

			InputStream ins = connection.getInputStream();
			InputStreamReader isr = new InputStreamReader(ins);
			BufferedReader in = new BufferedReader(isr);

			String inputLine;
			while ((inputLine = in.readLine()) != null) {
						 System.out.println(inputLine);
			}
			in.close();

		} catch (Exception e) {
					e.printStackTrace();
		}
	}
}